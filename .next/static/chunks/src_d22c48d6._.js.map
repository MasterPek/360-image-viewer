{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///project/sandbox/user-workspace/src/components/Image360Viewer.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef } from 'react';\nimport { Viewer } from '@photo-sphere-viewer/core';\nimport '@photo-sphere-viewer/core/index.css';\n\ninterface Image360ViewerProps {\n  imageUrl: string;\n  width?: string;\n  height?: string;\n}\n\nexport default function Image360Viewer({ imageUrl, width = '100%', height = '500px' }: Image360ViewerProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const viewerRef = useRef<Viewer | null>(null);\n\n  useEffect(() => {\n    if (containerRef.current && !viewerRef.current) {\n      viewerRef.current = new Viewer({\n        container: containerRef.current,\n        panorama: imageUrl,\n        size: {\n          width: width,\n          height: height\n        },\n        navbar: [\n          'autorotate',\n          'zoom',\n          'fullscreen'\n        ],\n        defaultZoomLvl: 0,\n        mousewheel: true,\n        touchmoveTwoFingers: true,\n      });\n    }\n\n    return () => {\n      if (viewerRef.current && containerRef.current?.contains(viewerRef.current.container)) {\n        viewerRef.current.destroy();\n      }\n    };\n  }, [imageUrl, width, height]);\n\n  return <div ref={containerRef} style={{ width, height }} />;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;;AAYe,SAAS,eAAe,EAAE,QAAQ,EAAE,QAAQ,MAAM,EAAE,SAAS,OAAO,EAAuB;;IACxG,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAkB;IAC5C,MAAM,YAAY,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAiB;IAExC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,IAAI,aAAa,OAAO,IAAI,CAAC,UAAU,OAAO,EAAE;gBAC9C,UAAU,OAAO,GAAG,IAAI,yKAAA,CAAA,SAAM,CAAC;oBAC7B,WAAW,aAAa,OAAO;oBAC/B,UAAU;oBACV,MAAM;wBACJ,OAAO;wBACP,QAAQ;oBACV;oBACA,QAAQ;wBACN;wBACA;wBACA;qBACD;oBACD,gBAAgB;oBAChB,YAAY;oBACZ,qBAAqB;gBACvB;YACF;YAEA;4CAAO;oBACL,IAAI,UAAU,OAAO,IAAI,aAAa,OAAO,EAAE,SAAS,UAAU,OAAO,CAAC,SAAS,GAAG;wBACpF,UAAU,OAAO,CAAC,OAAO;oBAC3B;gBACF;;QACF;mCAAG;QAAC;QAAU;QAAO;KAAO;IAE5B,qBAAO,6LAAC;QAAI,KAAK;QAAc,OAAO;YAAE;YAAO;QAAO;;;;;;AACxD;GAhCwB;KAAA","debugId":null}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///project/sandbox/user-workspace/src/app/embed/%5Btoken%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { Box, CircularProgress, Typography } from '@mui/material';\nimport Image360Viewer from '../../../components/Image360Viewer';\n\ninterface ImageData {\n  id: string;\n  url: string;\n}\n\nexport default function EmbedPage({ params }: { params: { token: string } }) {\n  const [image, setImage] = useState<ImageData | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchImage = async () => {\n      try {\n        // First, validate the token and get the image ID\n        const tokenResponse = await fetch(`/api/share?token=${params.token}`);\n        if (!tokenResponse.ok) {\n          throw new Error('Invalid or expired share link');\n        }\n        \n        const { imageId } = await tokenResponse.json();\n        \n        // Then fetch the image data\n        const imageResponse = await fetch(`/api/images/${imageId}`);\n        if (!imageResponse.ok) {\n          throw new Error('Failed to load image');\n        }\n        \n        const imageData = await imageResponse.json();\n        setImage(imageData);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'An error occurred');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchImage();\n  }, [params.token]);\n\n  if (isLoading) {\n    return (\n      <Box\n        sx={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: '100vh',\n        }}\n      >\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Box\n        sx={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: '100vh',\n        }}\n      >\n        <Typography color=\"error\">{error}</Typography>\n      </Box>\n    );\n  }\n\n  if (!image) {\n    return (\n      <Box\n        sx={{\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          height: '100vh',\n        }}\n      >\n        <Typography>Image not found</Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ height: '100vh' }}>\n      <Image360Viewer\n        imageUrl={image.url}\n        width=\"100%\"\n        height=\"100%\"\n      />\n    </Box>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAJA;;;;AAWe,SAAS,UAAU,EAAE,MAAM,EAAiC;;IACzE,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAoB;IACrD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE3C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;+BAAE;YACR,MAAM;kDAAa;oBACjB,IAAI;wBACF,iDAAiD;wBACjD,MAAM,gBAAgB,MAAM,MAAM,CAAC,iBAAiB,EAAE,OAAO,KAAK,EAAE;wBACpE,IAAI,CAAC,cAAc,EAAE,EAAE;4BACrB,MAAM,IAAI,MAAM;wBAClB;wBAEA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,cAAc,IAAI;wBAE5C,4BAA4B;wBAC5B,MAAM,gBAAgB,MAAM,MAAM,CAAC,YAAY,EAAE,SAAS;wBAC1D,IAAI,CAAC,cAAc,EAAE,EAAE;4BACrB,MAAM,IAAI,MAAM;wBAClB;wBAEA,MAAM,YAAY,MAAM,cAAc,IAAI;wBAC1C,SAAS;oBACX,EAAE,OAAO,KAAK;wBACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;oBAChD,SAAU;wBACR,aAAa;oBACf;gBACF;;YAEA;QACF;8BAAG;QAAC,OAAO,KAAK;KAAC;IAEjB,IAAI,WAAW;QACb,qBACE,6LAAC,oLAAA,CAAA,MAAG;YACF,IAAI;gBACF,SAAS;gBACT,gBAAgB;gBAChB,YAAY;gBACZ,QAAQ;YACV;sBAEA,cAAA,6LAAC,2NAAA,CAAA,mBAAgB;;;;;;;;;;IAGvB;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC,oLAAA,CAAA,MAAG;YACF,IAAI;gBACF,SAAS;gBACT,gBAAgB;gBAChB,YAAY;gBACZ,QAAQ;YACV;sBAEA,cAAA,6LAAC,yMAAA,CAAA,aAAU;gBAAC,OAAM;0BAAS;;;;;;;;;;;IAGjC;IAEA,IAAI,CAAC,OAAO;QACV,qBACE,6LAAC,oLAAA,CAAA,MAAG;YACF,IAAI;gBACF,SAAS;gBACT,gBAAgB;gBAChB,YAAY;gBACZ,QAAQ;YACV;sBAEA,cAAA,6LAAC,yMAAA,CAAA,aAAU;0BAAC;;;;;;;;;;;IAGlB;IAEA,qBACE,6LAAC,oLAAA,CAAA,MAAG;QAAC,IAAI;YAAE,QAAQ;QAAQ;kBACzB,cAAA,6LAAC,uIAAA,CAAA,UAAc;YACb,UAAU,MAAM,GAAG;YACnB,OAAM;YACN,QAAO;;;;;;;;;;;AAIf;GAxFwB;KAAA","debugId":null}}]
}